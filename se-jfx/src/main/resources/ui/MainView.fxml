<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<ScrollPane fx:id="rootScroll" fitToHeight="true" fitToWidth="false" pannable="true" xmlns="http://javafx.com/javafx/17.0.12" xmlns:fx="http://javafx.com/fxml/1" fx:controller="ui.MainController">
   <content>
      <BorderPane fx:id="rootContent" maxHeight="Infinity" maxWidth="Infinity" minHeight="400" minWidth="700" prefHeight="700.0" prefWidth="1000.0">

         <!-- ===== TOP BAR ===== -->
         <top>
            <VBox spacing="4">
               <HBox spacing="6">
                  <padding>
                     <Insets bottom="0" left="6" right="6" top="6" />
                  </padding>

                  <Button fx:id="btnLoadFile" minHeight="-Infinity" minWidth="-Infinity" onAction="#onLoadXml" prefHeight="25.0" prefWidth="149.0" text="Load File" />

                  <Label minHeight="-Infinity" minWidth="-Infinity" prefHeight="22.0" prefWidth="48.0" text="File path:" />
                  <Label fx:id="programNameLabel" prefHeight="23.0" prefWidth="751.0" text="(none)" />

               </HBox>

               <ToolBar>
                  <Label text="Program/Function:" />
                  <ComboBox fx:id="contextSelector" prefWidth="180" />

                  <Separator orientation="VERTICAL" />

                  <Label text="Degree:" />
                  <ComboBox fx:id="degreeSelector" prefWidth="100" />

                  <Separator orientation="VERTICAL" />

                  <Label text="Highlight selection:" />
                  <ComboBox fx:id="highlightSelector" prefWidth="200" />
               </ToolBar>
            </VBox>
         </top>

         <!-- ===== CENTER: LEFT/RIGHT SPLIT ===== -->
         <center>
            <SplitPane dividerPositions="0.68">
               <SplitPane dividerPositions="0.6443452380952381" orientation="VERTICAL" prefHeight="200.0" prefWidth="160.0">
                  <items>
                     <VBox prefHeight="430.0" prefWidth="676.0">
                        <children>

                           <!-- Main Instructions Table (reused component) -->
                           <fx:include fx:id="mainInstrTable" source="components/InstructionTable.fxml" VBox.vgrow="ALWAYS" />

                           <!-- Summary line -->
                           <fx:include fx:id="summaryLine" source="components/SummaryLine.fxml"/>
                        </children>
                     </VBox>

                     <!-- Selected instruction history chain (same component reused) -->
                     <TitledPane expanded="true" prefWidth="660.0" text="Instruction History Chain">
                        <content>
                           <fx:include fx:id="historyInstrTable" source="components/InstructionTable.fxml" />
                        </content>
                     </TitledPane>
                  </items>
               </SplitPane>
               <!-- ===== RIGHT SIDE ===== -->
               <VBox fx:id="rightPane" spacing="10">
                  <padding>
                     <Insets bottom="8" left="0" right="8" top="8" />
                  </padding>

                  <!-- Debugger / Execution controls -->
                  <TitledPane expanded="true" text="Debugger / Execution">
                     <content>
                        <VBox spacing="8">
                           <padding>
                              <Insets bottom="8" left="8" right="8" top="8" />
                           </padding>
                           <HBox alignment="CENTER" spacing="8">
                              <Button fx:id="btnRun" alignment="CENTER" contentDisplay="CENTER" maxWidth="1.7976931348623157E308" onAction="#onRun" prefHeight="25.0" prefWidth="148.0" text="Run" />
                              <Button fx:id="btnDebug" alignment="CENTER" contentDisplay="CENTER" disable="true" maxWidth="1.7976931348623157E308" onAction="#onDebug" prefHeight="25.0" prefWidth="132.0" text="Debug" />
                           </HBox>
                           <HBox alignment="CENTER" spacing="8">
                              <Button fx:id="btnStop" alignment="CENTER" contentDisplay="CENTER" disable="true" onAction="#onStop" prefHeight="25.0" prefWidth="70.0" text="Stop" />
                              <Button fx:id="btnResume" alignment="CENTER" contentDisplay="CENTER" disable="true" onAction="#onResume" text="Resume" />
                              <Button fx:id="btnStepOver" alignment="CENTER" contentDisplay="CENTER" disable="true" onAction="#onStepOver" text="Step Over" />
                              <Button fx:id="btnStepBack" alignment="CENTER" contentDisplay="CENTER" disable="true" onAction="#onStepBack" text="Step Back" />
                           </HBox>
                        </VBox>
                     </content>
                  </TitledPane>

                  <!-- Variables + Dynamic Inputs -->
                  <HBox prefWidth="193.0" spacing="8">
                     <!-- Variables (component) -->
                     <fx:include fx:id="varsPane" source="components/VariablesTable.fxml" />

                     <!-- Dynamic Inputs (component builds only relevant x_i) -->
                     <fx:include fx:id="inputsPane" source="components/DynamicInputsPane.fxml" HBox.hgrow="ALWAYS" />
                  </HBox>

                  <!-- Cycles row -->
                  <HBox spacing="6">
                     <Label text="Cycles:">
                        <HBox.margin>
                           <Insets left="5.0" />
                        </HBox.margin>
                     </Label>
                     <Label fx:id="cyclesLabel" text="0" />
                  </HBox>
                  <AnchorPane prefHeight="200.0" prefWidth="200.0" VBox.vgrow="SOMETIMES">
                     <children>
      
                        <!-- Run History (component) -->
                        <fx:include fx:id="runsPane" source="components/RunHistoryTable.fxml" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0" VBox.vgrow="ALWAYS" />
                     </children>
                  </AnchorPane>

               </VBox>
            </SplitPane>
         </center>

      </BorderPane>
   </content>
</ScrollPane>
